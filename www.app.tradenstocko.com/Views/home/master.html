
<!DOCTYPE html>
<html>
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.12.15/dist/sweetalert2.all.min.js"></script>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.5, maximum-scale=1.0, user-scalable=no" />
    <title>@ViewBag.Title | Educating Stock</title>
    <link rel="icon" href="Content/img/crazy-logo.jpg" type="image/png" />
    <!-- themefy CSS -->
    <link rel="stylesheet" href="Content/vendors/themefy_icon/themify-icons.css" />
    <link rel="stylesheet" href="Content/vendors/font_awesome/css/all.min.css" />
    <!-- text editor css -->
    <link rel="stylesheet" href="Content/vendors/material_icon/material-icons.css" />
    <!-- plugins CSS -->
    <link rel="stylesheet" href="Content/css/plugins.css" />
    <!-- Media CSS -->
    <link rel="stylesheet" href="Content/css/media.css" />
    <link href="Content/css/tabcss.css" rel="stylesheet" />
    <style>
        .inactivenav {
            color: #8494a3;
            font-size: 13px;
        }

        .activenav {
            color: white;
            font-size: 22px;
        }
    </style>
    <script src="Content/js/bootstrap.min.js"></script>
    <script src="Content/js/jquery-3.4.1.min.js"></script>
</head>
<body oncontextmenu="return false" class="crm_body_bg">


    <div id="userprofile" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content" style="border:1px solid #2f8aa2">
                <div class="modal-header">
                    <table class="table">
                        <tr>
                            <td>
                                <b>User Profile</b>
                            </td>
                            <td>
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="modal-body" style="text-align:center">
                    <table id="userprofiledata" width="100%" class="table table-bordered table-striped">
                    </table>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-info" data-dismiss="modal" onclick="closesellmodel()">Close</button>
                </div>
            </div>
        </div>
    </div>

    <nav class="sidebar vertical-scroll  ps-container ps-theme-default ps-active-y">
        <div class="logo side-logo">
            <a href="index.html"><img src="Content/img/crazy-logo.jpg" alt=""></a>
            <div class="sidebar_close_icon d-lg-none">
                <i class="ti-close"></i>
            </div>
        </div>
        <ul id="sidebar_menu">

            <!--<li class="mm-active">
            <a class="has-arrow" href="/home/dashboard" aria-expanded="false">
                <!-- <i class="fas fa-th"></i>
                <div class="icon_menu">
                    <img src="Content/img/menu-icon/dashboard.svg" alt="">
                </div>
                <span>DASHBOARD</span>
                </a>
                </li> -->

            <li class="">
                <a class="has-arrow" href="/home/tradedetails" aria-expanded="false">
                    <div class="icon_menu">
                        <img src="Content/img/menu-icon/3.svg" alt="">
                    </div>
                    <span>TRADES</span>
                </a>
            </li>
            <li class="">
                <a class="has-arrow" href="/home/accounts" aria-expanded="false">

                    <div class="icon_menu">
                        <img src="Content/img/menu-icon/4.svg" alt="">
                    </div>
                    <span>ACCOUNT</span>
                </a>
            </li>
        </ul>
    </nav>



    <section class="main_content dashboard_part">
        <!-- menu -->
        <div class="container-fluid">
            <div class="row">

            </div>
        </div>
        <div class="mobile-nav">
            <a id="marketwatchapp" href="#" onclick="openconetnt('marketwatch')" ><i class="fas fa-rupee-sign"></i><b>Wachlist</b> </a>
            <a id="tradedetailsapp" href="#" onclick="openconetnt('trade')"><i class="ti-book"></i><b>Trades</b> </a>
            <a id="portfolioapp" href="#" onclick="openconetnt('portfolioapp')"><i class="ti-briefcase"></i> <b>Portfolio</b></a>
            <a id="accounts" href="#" onclick="openconetnt('accounts')"><i class="ti-user"></i> <b>Account</b></a>
        </div>
        <!--/ menu  -->
        <div id="appcontent">

        </div>
    </section>

    <div id="back-top" style="display: none;">
        <a title="Go to Top" href="#">
            <i class="ti-angle-up"></i>
        </a>
    </div>
    <!--<iframe style="display:none" id="IframeAdm" name="IFrameAdm" width="100%" height="100%" border="none" src="/Home/Autosqarapartialview"></iframe>
    <iframe style="display:none" id="Iframeptoa" name="IFrameAdm" width="100%" height="100%" border="none" src="/Home/AutosqaraPendingToActive"></iframe>-->

    <!-- popper js -->
    <!-- bootstarp js -->
   
    <script>

        function openconetnt(windowname) {
            if (windowname == "marketwatch") {
                $("#appcontent").load("marketwatchapp.html");
                $("#marketwatchapp").removeClass("inactivenav");
                $("#marketwatchapp").addClass("activenav");

                $("#tradedetailsapp").removeClass("activenav");
                $("#tradedetailsapp").addClass("inactivenav");
              
                $("#portfolioapp").removeClass("activenav");
                $("#portfolioapp").addClass("inactivenav");

                $("#accounts").removeClass("activenav");
                $("#accounts").addClass("inactivenav");

            }
            else if (windowname == "trade") {
                $("#appcontent").load("tradedetailsapp.html");

                $("#marketwatchapp").removeClass("activenav");
                $("#marketwatchapp").addClass("inactivenav");

                $("#tradedetailsapp").removeClass("inactivenav");
                $("#tradedetailsapp").addClass("activenav");

                $("#portfolioapp").removeClass("activenav");
                $("#portfolioapp").addClass("inactivenav");

                $("#accounts").removeClass("activenav");
                $("#accounts").addClass("inactivenav");

            }
            else if (windowname == "portfolioapp") {
                $("#appcontent").load("portfolioapp.html");

                $("#marketwatchapp").removeClass("activenav");
                $("#marketwatchapp").addClass("inactivenav");

                $("#tradedetailsapp").removeClass("activenav");
                $("#tradedetailsapp").addClass("inactivenav");

                $("#portfolioapp").removeClass("inactivenav");
                $("#portfolioapp").addClass("activenav");

                $("#accounts").removeClass("activenav");
                $("#accounts").addClass("inactivenav");
            }
            else if (windowname == "accounts") {
                $("#appcontent").load("accounts.html");
           
                $("#marketwatchapp").removeClass("activenav");
                $("#marketwatchapp").addClass("inactivenav");

                $("#tradedetailsapp").removeClass("activenav");
                $("#tradedetailsapp").addClass("inactivenav");

                $("#portfolioapp").removeClass("activenav");
                $("#portfolioapp").addClass("inactivenav");

                $("#accounts").removeClass("inactivenav");
                $("#accounts").addClass("activenav");
            }
        }



        function logout() {
            localStorage.removeItem("userid");
            location.href = "/login/index";
        }

        $(document).ready(function () {
            $("#appcontent").load("marketwatchapp.html");
            var locationname = location.pathname
            if (locationname == "/home/marketwatchapp") {
                $("#marketwatchapp").addClass("active");
            } else if (locationname == "/home/tradedetailsapp") {
                $("#tradedetailsapp").addClass("active");
            } else if (locationname == "/home/portfolioapp") {
                $("#portfolioapp").addClass("active");
            } else if (locationname == "/home/accounts") {
                $("#accounts").addClass("active");
            }
            var userid = localStorage.getItem("userid");
            if (userid == null) {
                location.href = "/login/index";
            }
            logincheck();
            userprofile();

            var ismcxtrade = localStorage.getItem("IsMCXTrade");
            if (ismcxtrade == "true") {
                var data = "<li id='mcxmenu'>";
                data += "<a class='has-arrow' href = '/home/mcxfuture' aria-expanded='false'>";
                data += "<div class='icon_menu'>";
                data += " <img src='/Content/img/menu-icon/5.svg' alt=''>";
                data += "</div>";
                data += " <span>TRADE IN MCX</span>";
                data += " </a>";
                data += " </li >";
                $("#sidebar_menu").append(data);

            }

            var isnsetrade = localStorage.getItem("IsNSETrade");
            if (isnsetrade == "true") {
                var data = "<li id='nsemenu'>";
                data += "<a class='has-arrow' href = '/home/nsefuture' aria-expanded='false'>";
                data += "<div class='icon_menu'>";
                data += " <img src='/Content/img/menu-icon/5.svg' alt=''>";
                data += "</div>";
                data += " <span>TRADE IN NSE</span>";
                data += " </a>";
                data += " </li >";
                $("#sidebar_menu").append(data);
            }

            var iscdstrade = localStorage.getItem("IsCDSTrade");
            if (iscdstrade == "true") {
                var data = "<li id='cdsmenu'>";
                data += "<a class='has-arrow' href = '/home/option' aria-expanded='false'>";
                data += "<div class='icon_menu'>";
                data += " <img src='/Content/img/menu-icon/5.svg' alt=''>";
                data += "</div>";
                data += " <span>TRADE IN OPTION</span>";
                data += " </a>";
                data += " </li >";

                $("#sidebar_menu").append(data);
            }

            var usrnam = localStorage.getItem("ClientName");
            $("#username").html(usrnam);
            $("#usernameh1").html(usrnam);
        });

        function getdeviceid() {
            let machineId = localStorage.getItem('MachineId');
            if (!machineId) {
                machineId = crypto.randomUUID();
                localStorage.setItem('MachineId', machineId);
            }
            return machineId;
        }

        function logincheck() {
            var userid = localStorage.getItem("userid");
            $.ajax({
                url: "https://app.kingdomexch.com/api/refreshdata/?userid=" + userid,
                type: "get",
                success: function (response) {
                    if (response == "false")
                    {
                        alert("Login has been Expired.");
                        logout();
                        return;
                    }
                    else if (response == "Bloked")
                    {
                        alert("Account has been Bloked. Please contact to Admin");
                        logout();
                        return;
                    }
                    var data = JSON.parse(response);
                    //Check ValidTill
                    console.log("refdata", data)
                    var Password_ = data.Password_;
                    var oldpassword = localStorage.getItem("oldpassword");
                    if (oldpassword != Password_) {
                        alert("Your Password has been Changed. Please login again");
                        logout();
                        return;
                    }
                    if (data.IsMCXTrade == "false") {
                        $("#mcxmenu").hide();
                        $("#mcxtabmenu").hide();

                    } else {
                        $("#mcxmenu").show();
                        $("#mcxtabmenu").show();
                    }
                    if (data.IsNSETrade == "false") {
                        $("#nsemenu").hide();
                        $("#nsetabmenu").hide();
                    } else {
                        $("#nsemenu").show();
                        $("#nsetabmenu").show();
                    }
                    if (data.IsCDSTrade == "false") {
                        $("#cdsmenu").hide();
                        $("#cdstabmenu").hide();
                    } else {
                        $("#cdsmenu").show();
                        $("#cdstabmenu").show();
                    }

                    localStorage.setItem("trademcxunits", data.TradeMCXUnits);
                    localStorage.setItem("tradeequityunits", data.TradeEquityUnits);
                    localStorage.setItem("tradecdsunits", data.TradeCDSUnits);
                    localStorage.setItem("profittradestoptime", data.profittradestoptime);

                    localStorage.setItem("userid", data.UserId);
                    localStorage.setItem("ClientName", data.ClientName);
                    localStorage.setItem("Refid", data.Refid);
                    localStorage.setItem("MobileNo", data.MobileNo);
                    localStorage.setItem("EmailId", data.EmailId);
                    localStorage.setItem("IsMCXTrade", data.IsMCXTrade);
                    localStorage.setItem("IsNSETrade", data.IsNSETrade);
                    localStorage.setItem("IsCDSTrade", data.IsCDSTrade);
                    localStorage.setItem("CreditLimit", data.CreditLimit);
                    localStorage.setItem("LedgerBalance", data.LedgerBalance);
                    localStorage.setItem("TotalActive", data.TotalActive);
                    localStorage.setItem("TotalPending", data.TotalPending);
                    localStorage.setItem("TotalClosed", data.TotalClosed);
                    localStorage.setItem("AllowOrdersCurrentBid", data.AllowOrdersCurrentBid);
                    localStorage.setItem("AllowFreshEntryHighAndBelow", data.AllowFreshEntryHighAndBelow);
                    localStorage.setItem("AllowOrdersHighLow", data.AllowOrdersHighLow);
                    localStorage.setItem("AutoCloseTradesLossesLimit", data.AutoCloseTradesLossesLimit);
                    localStorage.setItem("auto_close_all_active_trades_when_the_losses_reach", data.auto_close_all_active_trades_when_the_losses_reach);

                    //MCX Brokerage
                    localStorage.setItem("Mcx_Brokerage_Type", data.Mcx_Brokerage_Type);
                    localStorage.setItem("MCX_brokerage_per_crore", data.MCX_brokerage_per_crore);
                    localStorage.setItem("BULLDEX_brokerage", data.BULLDEX_brokerage);
                    localStorage.setItem("GOLD_brokerage", data.GOLD_brokerage);
                    localStorage.setItem("SILVER_brokerage", data.SILVER_brokerage);
                    localStorage.setItem("CRUDEOIL_brokerage", data.CRUDEOIL_brokerage);
                    localStorage.setItem("COPPER_brokerage", data.COPPER_brokerage);
                    localStorage.setItem("NICKEL_brokerage", data.NICKEL_brokerage);
                    localStorage.setItem("ZINC_brokerage", data.ZINC_brokerage);
                    localStorage.setItem("LEAD_brokerage", data.LEAD_brokerage)
                    localStorage.setItem("NATURALGAS_brokerage", data.NATURALGAS_brokerage);
                    localStorage.setItem("ALUMINIUM_brokerage", data.ALUMINIUM_brokerage);
                    localStorage.setItem("MENTHAOIL_brokerage", data.MENTHAOIL_brokerage);
                    localStorage.setItem("COTTON_brokerage", data.COTTON_brokerage);
                    localStorage.setItem("CPO_brokerage", data.CPO_brokerage);
                    localStorage.setItem("GOLDM_brokerage", data.GOLDM_brokerage);
                    localStorage.setItem("SILVERMINI_brokerage", data.SILVERMINI_brokerage);
                    localStorage.setItem("SILVERMIC_brokerage", data.SILVERMIC_brokerage);

                    //MCX Intrday
                    localStorage.setItem("Mcx_Exposure_Type", data.Mcx_Exposure_Type);
                    localStorage.setItem("Intraday_Exposure_Margin_MCX", data.Intraday_Exposure_Margin_MCX);
                    localStorage.setItem("Holding_Exposure_Margin_MCX", data.Holding_Exposure_Margin_MCX);
                    localStorage.setItem("MCX_Exposure_Lot_wise_BULLDEX_Intraday", data.MCX_Exposure_Lot_wise_BULLDEX_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_BULLDEX_Holding", data.MCX_Exposure_Lot_wise_BULLDEX_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_GOLD_Intraday", data.MCX_Exposure_Lot_wise_GOLD_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_GOLD_Holding", data.MCX_Exposure_Lot_wise_GOLD_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_SILVER_Intraday", data.MCX_Exposure_Lot_wise_SILVER_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_SILVER_Holding", data.MCX_Exposure_Lot_wise_SILVER_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_CRUDEOIL_Intraday", data.MCX_Exposure_Lot_wise_CRUDEOIL_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_CRUDEOIL_Holding", data.MCX_Exposure_Lot_wise_CRUDEOIL_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_COPPER_Intraday", data.MCX_Exposure_Lot_wise_COPPER_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_COPPER_Holding", data.MCX_Exposure_Lot_wise_COPPER_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_NICKEL_Intraday", data.MCX_Exposure_Lot_wise_NICKEL_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_NICKEL_Holding", data.MCX_Exposure_Lot_wise_NICKEL_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_ZINC_Intraday", data.MCX_Exposure_Lot_wise_ZINC_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_ZINC_Holding", data.MCX_Exposure_Lot_wise_ZINC_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_LEAD_Intraday", data.MCX_Exposure_Lot_wise_LEAD_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_LEAD_Holding", data.MCX_Exposure_Lot_wise_LEAD_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_NATURALGAS_Intraday", data.MCX_Exposure_Lot_wise_NATURALGAS_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_NATURALGAS_Holding", data.MCX_Exposure_Lot_wise_NATURALGAS_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_ALUMINIUM_Intraday", data.MCX_Exposure_Lot_wise_ALUMINIUM_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_ALUMINIUM_Holding", data.MCX_Exposure_Lot_wise_ALUMINIUM_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_MENTHAOIL_Intraday", data.MCX_Exposure_Lot_wise_MENTHAOIL_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_MENTHAOIL_Holding", data.MCX_Exposure_Lot_wise_MENTHAOIL_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_COTTON_Intraday", data.MCX_Exposure_Lot_wise_COTTON_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_COTTON_Holding", data.MCX_Exposure_Lot_wise_COTTON_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_CPO_Intraday", data.MCX_Exposure_Lot_wise_CPO_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_CPO_Holding", data.MCX_Exposure_Lot_wise_CPO_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_GOLDM_Intraday", data.MCX_Exposure_Lot_wise_GOLDM_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_GOLDM_Holding", data.MCX_Exposure_Lot_wise_GOLDM_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_SILVERM_Intraday", data.MCX_Exposure_Lot_wise_SILVERM_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_SILVERM_Holding", data.MCX_Exposure_Lot_wise_SILVERM_Holding);
                    localStorage.setItem("MCX_Exposure_Lot_wise_SILVERMIC_Intraday", data.MCX_Exposure_Lot_wise_SILVERMIC_Intraday);
                    localStorage.setItem("MCX_Exposure_Lot_wise_SILVERMIC_Holding", data.MCX_Exposure_Lot_wise_SILVERMIC_Holding);

                    //NSE

                    localStorage.setItem("NSE_Brokerage_Type", data.NSE_Brokerage_Type);
                    localStorage.setItem("Equity_brokerage_per_crore", data.Equity_brokerage_per_crore);

                    localStorage.setItem("NSE_Exposure_Type", data.NSE_Exposure_Type);
                    localStorage.setItem("Intraday_Exposure_Margin_Equity", data.Intraday_Exposure_Margin_EQUITY);
                    localStorage.setItem("Holding_Exposure_Margin_Equity", data.Holding_Exposure_Margin_EQUITY);

                    //CDS
                    localStorage.setItem("CDS_Brokerage_Type", data.CDS_Brokerage_Type);
                    localStorage.setItem("CDS_brokerage_per_crore", data.CDS_brokerage_per_crore);

                    localStorage.setItem("CDS_Exposure_Type", data.CDS_Exposure_Type);
                    localStorage.setItem("Intraday_Exposure_Margin_CDS", data.Intraday_Exposure_Margin_CDS);
                    localStorage.setItem("Holding_Exposure_Margin_CDS", data.Holding_Exposure_Margin_CDS);

                    var LedgerBalance = localStorage.getItem("LedgerBalance");
                    var TotalActive = localStorage.getItem("TotalActive");
                    var TotalPending = localStorage.getItem("TotalPending");
                    var TotalClosed = localStorage.getItem("TotalClosed");
                    var username = localStorage.getItem("ClientName");
                    LedgerBalance = parseFloat(LedgerBalance).toFixed(2);
                    $("#ldgb").html(LedgerBalance);
                    $("#ta").html(TotalActive);
                    $("#tp").html(TotalPending);
                    $("#tc").html(TotalClosed);
                    $("#usernamess").html(username);
                }
            });
        }

        function checktrademethod(exchangetype) {
            if (exchangetype == "MCX") {
                return localStorage.getItem("trademcxunits");
            }
            if (exchangetype == "NSE") {
                return localStorage.getItem("tradeequityunits");
            }
            if (exchangetype == "OPT") {
                return localStorage.getItem("tradecdsunits");
            }
        }

        function userprofile() {
            logincheck();
            var userid = localStorage.getItem("userid");
            $.ajax({
                url: "https://app.kingdomexch.com/api/userprofile/?userid=" + userid,
                type: "get",
                success: function (response) {
                    var data = JSON.parse(response);
                    var usrbalnce = "";
                    $.each(data, function (i, item) {
                        var FirstName = data[i].FirstName;
                        var LastName = data[i].LastName;
                        var UserName = data[i].UserName;
                        var CreditLimit = data[i].CreditLimit;
                        var LedgerBalance = data[i].LedgerBalance;
                        var MobileNo = data[i].MobileNo;
                        var EmailId = data[i].EmailId;
                        var AadharNo = data[i].AadharNo;
                        var PanNo = data[i].PanNo;
                        var City = data[i].City;
                        var Address = data[i].Address;

                        usrbalnce += "<tr><td>First Name</td><td   align='left'>" + FirstName + "</td></tr>";
                        usrbalnce += "<tr><td>Last Name</td><td  align='left'>" + LastName + "</td></tr>";
                        usrbalnce += "<tr><td>User Name</td><td   align='left'>" + UserName + "</td></tr>";
                        usrbalnce += "<tr><td>Credit Limit</td><td   align='left'>" + CreditLimit + "</td></tr>";
                        usrbalnce += "<tr><td>Ledger Balance</td><td   align='left'>" + LedgerBalance + "</td></tr>";
                        usrbalnce += "<tr><td>Mobile No</td><td   align='left'>" + MobileNo + "</td></tr>";
                        usrbalnce += "<tr><td>Email Id</td><td   align='left'>" + EmailId + "</td></tr>";
                        usrbalnce += "<tr><td>Aadhar No</td><td   align='left'>" + AadharNo + "</td></tr>";
                        usrbalnce += "<tr><td>PanNo.</td><td   align='left'>" + PanNo + "</td></tr>";
                        usrbalnce += "<tr><td>City</td><td   align='left'>" + City + "</td></tr>";
                        usrbalnce += "<tr><td>Address</td><td   align='left'>" + Address + "</td></tr>";

                    });
                    $("#userprofiledata").html(usrbalnce);
                }
            });
        }

    </script>
</body>
</html>
